map=null,markers={},markers_id_order=[],current_chenge_marker_id=void 0,current_chenge_marker_icon=void 0,marker_agent=void 0,__is_map_exist=function(){return!!map},create_map=function(){if(__is_map_exist())console.log("there is a map already");else{var e=document.getElementById("map-canvas"),a=new google.maps.LatLng(35.792621,139.806513),r={zoom:5,center:a};map=new google.maps.Map(e,r)}},create_marker_agent=function(e,a){void 0!=marker_agent&&marker_agent.setMap(null),marker_agent=new google.maps.Marker({map:map,position:new google.maps.LatLng(e,a),opacity:.4,icon:new google.maps.MarkerImage("/assets/default-marker.png",new google.maps.Size(70,80))})},create_marker=function(e,a,r){__is_map_exist()?(markers[r]=new google.maps.Marker({map:map,position:new google.maps.LatLng(e,a),icon:new google.maps.MarkerImage("/assets/default-marker.png",new google.maps.Size(70,80))}),markers_id_order.push(r)):console.log("there is no map")},set_marker_icon=function(e,a,r){markers[e].setOptions({icon:new google.maps.MarkerImage(a,new google.maps.Size(r[0],r[1]))})},chenge_current_marker_design=function(e){void 0!=current_chenge_marker_id&&void 0!=markers[current_chenge_marker_id]&&markers[current_chenge_marker_id].setOptions({icon:current_chenge_marker_icon}),current_chenge_marker_id=e,current_chenge_marker_icon=markers[e].getIcon(),set_marker_icon(e,"/assets/click-marker.png",[100,100])},add_marker_event=function(e){google.maps.event.addListener(e,"click",function(){var a=e.position.lat(),r=e.position.lng(),o=parseFloat($(".radius-value").text());console.log(a),console.log(r),console.log(o),$("#search-hotel-button .search-lat").val(a),$("#search-hotel-button .search-lng").val(r),$("#search-hotel-button .search-radius").val(o),$("#search-hotel-button .do-search").trigger("click")})},move_map_center=function(e,a){if(1==markers_id_order.length){var r=new google.maps.LatLng(e,a);map.setCenter(r),map.setZoom(15)}else{for(var e=[],a=[],r=null,o=0;o<markers_id_order.length;o++)r=markers[markers_id_order[o]].getPosition(),e[o]=r.lat(),a[o]=r.lng();var n=Math.min.apply(null,e),t=Math.min.apply(null,a),_=Math.max.apply(null,e),i=Math.max.apply(null,a),m=new google.maps.LatLng(n,t),s=new google.maps.LatLng(_,i),g=new google.maps.LatLngBounds(m,s);map.fitBounds(g)}},top_init_gmap=function(){create_map();var e=gon.voted_items_info[0].length;if(e>0){for(var a=0;e-1>a;a++){var r=gon.voted_items_info[1][a],o=gon.voted_items_info[2][a];create_marker(r[0],r[1],o)}var n=gon.voted_items_info[1][e-1],t=gon.voted_items_info[2][e-1];create_marker(n[0],n[1],t),move_map_center(n[0],n[1])}},owner_init_gmap=function(){top_init_gmap(),adapt_voted_result()},adapt_voted_result=function(){var e=gon.voted_items_info[0].length,a=1e5,r=0,o="";if(e>0){for(var n=0;e-1>n;n++){var t=(gon.voted_items_info[1][n],gon.voted_items_info[2][n]),_=gon.voted_items_info[3][n],i=gon.voted_items_info[4][n];a>_&&(r+=1,o="/assets/marker"+r+".png",a=_),"hotel"!=i&&set_marker_icon(t,o,[100,100]),add_marker_event(markers[t])}var m=gon.voted_items_info[1][e-1],s=gon.voted_items_info[2][e-1],g=gon.voted_items_info[3][e-1],l=gon.voted_items_info[4][e-1];a>g&&(r+=1,o="/assets/marker"+r+".png"),"hotel"!=l&&set_marker_icon(s,o,[100,100]),add_marker_event(markers[s]),move_map_center(m[0],m[1])}};